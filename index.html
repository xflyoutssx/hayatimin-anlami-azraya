<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalp Toplama Oyunu</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @font-face {
            font-family: 'Minecraft';
            src: url('https://fonts.cdnfonts.com/s/14112/Minecraft.woff') format('woff');
        }

        body {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('wallpaper.jpg');
            background-size: cover;
            background-position: center;
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 15px;
            text-align: center;
            overflow-x: hidden;
            font-family: 'Minecraft', 'Courier New', monospace;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(255, 0, 128, 0.5);
            border: 2px solid #ff0080;
            margin: 0 auto;
        }

        h1 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            margin-bottom: 15px;
            color: #ff0080;
            text-shadow: 0 0 10px rgba(255, 0, 128, 0.7);
            font-family: 'Minecraft', 'Courier New', monospace;
            line-height: 1.2;
        }

        .subtitle {
            font-size: clamp(0.9rem, 3vw, 1.2rem);
            margin-bottom: 20px;
            color: #ffb6c1;
            font-family: 'Minecraft', 'Courier New', monospace;
            line-height: 1.3;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: clamp(0.9rem, 3vw, 1.2rem);
            background-color: rgba(255, 0, 128, 0.2);
            padding: 12px;
            border-radius: 8px;
            font-family: 'Minecraft', 'Courier New', monospace;
            flex-wrap: wrap;
            gap: 10px;
        }

        .game-info > div {
            flex: 1;
            min-width: 120px;
        }

        .game-area {
            position: relative;
            width: 100%;
            height: clamp(250px, 50vh, 400px);
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 15px;
            border: 2px solid rgba(255, 0, 128, 0.5);
        }

        #basket {
            position: absolute;
            bottom: 10px;
            width: clamp(80px, 20vw, 120px);
            height: 10px;
            background: linear-gradient(90deg, #ff0080, #ff3399);
            border-radius: 5px;
            transition: left 0.1s ease;
            z-index: 10;
            box-shadow: 0 0 15px rgba(255, 0, 128, 0.7);
        }

        .heart {
            position: absolute;
            width: clamp(25px, 8vw, 40px);
            height: clamp(25px, 8vw, 40px);
            background-image: url('kalp.png');
            background-size: contain;
            background-repeat: no-repeat;
            filter: drop-shadow(0 0 5px rgba(255, 0, 128, 0.7));
            z-index: 5;
            transition: all 0.3s ease;
        }

        .heart.collected {
            animation: collectAnimation 0.5s ease-out forwards;
        }

        @keyframes collectAnimation {
            0% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
            50% {
                transform: scale(1.5) rotate(180deg);
                opacity: 0.7;
            }
            100% {
                transform: scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            background-color: #ff0080;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 0, 128, 0.5);
            font-family: 'Minecraft', 'Courier New', monospace;
            min-width: 140px;
        }

        button:hover {
            background-color: #ff3399;
            transform: scale(1.05);
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: linear-gradient(135deg, #ff0080, #ff3399);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            font-size: clamp(0.9rem, 3vw, 1.2rem);
            z-index: 1000;
            transition: transform 0.5s ease;
            font-family: 'Minecraft', 'Courier New', monospace;
            max-width: 90%;
            text-align: center;
        }

        .notification.show {
            transform: translateX(-50%) translateY(0);
        }

        .progress-bar {
            height: 15px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #ff0080, #ff3399);
            border-radius: 8px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .completion-message {
            font-size: clamp(1.1rem, 4vw, 1.5rem);
            margin-top: 15px;
            color: #ff0080;
            text-shadow: 0 0 10px rgba(255, 0, 128, 0.7);
            display: none;
            font-family: 'Minecraft', 'Courier New', monospace;
            line-height: 1.3;
        }

        .instructions {
            margin-top: 12px;
            font-size: clamp(0.8rem, 2.5vw, 1rem);
            color: #ccc;
            font-family: 'Minecraft', 'Courier New', monospace;
            line-height: 1.3;
        }

        .romantic-messages {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(1rem, 4vw, 1.5rem);
            color: #ff0080;
            text-shadow: 0 0 10px rgba(255, 0, 128, 0.7);
            text-align: center;
            display: none;
            z-index: 20;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #ff0080;
            box-shadow: 0 0 20px rgba(255, 0, 128, 0.5);
            max-width: 90%;
            font-family: 'Minecraft', 'Courier New', monospace;
            line-height: 1.3;
        }

        .letter {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 95%;
            max-width: 600px;
            max-height: 90vh;
            background: #fffaf0;
            border: 5px solid #ff69b4;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 0 50px rgba(255, 0, 128, 0.7);
            z-index: 100;
            display: none;
            color: #8b008b;
            text-align: left;
            line-height: 1.4;
            font-family: 'Minecraft', 'Courier New', monospace;
            overflow-y: auto;
        }

        .letter-content {
            transform: scale(0.95);
            transition: transform 0.5s ease;
        }

        .letter.show {
            display: block;
            animation: letterAppear 0.8s forwards;
        }

        .letter.show .letter-content {
            transform: scale(1);
        }

        @keyframes letterAppear {
            0% {
                transform: translate(-50%, -50%) scale(0) rotate(-10deg);
            }
            70% {
                transform: translate(-50%, -50%) scale(1.1) rotate(5deg);
            }
            100% {
                transform: translate(-50%, -50%) scale(1) rotate(0deg);
            }
        }

        .letter-header {
            text-align: center;
            margin-bottom: 15px;
            border-bottom: 2px dotted #ff69b4;
            padding-bottom: 8px;
        }

        .couple-image {
            width: clamp(120px, 30vw, 200px);
            height: clamp(90px, 22vw, 150px);
            border-radius: 8px;
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(2rem, 6vw, 3rem);
            overflow: hidden;
            background: transparent !important;
        }

        .couple-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 8px;
        }

        .letter-text {
            margin-bottom: 15px;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
        }

        .letter-signature {
            text-align: center;
            font-style: italic;
            margin-top: 15px;
        }

        .love-button {
            display: block;
            margin: 20px auto 0;
            padding: 10px 25px;
            background: linear-gradient(135deg, #ff0080, #ff69b4);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: clamp(0.9rem, 3vw, 1.2rem);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 0, 128, 0.4);
            font-family: 'Minecraft', 'Courier New', monospace;
        }

        .love-button:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(255, 0, 128, 0.6);
        }

        .percentage-display {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(3rem, 15vw, 5rem);
            color: #ff0080;
            text-shadow: 0 0 20px rgba(255, 0, 128, 0.7);
            z-index: 1000;
            display: none;
            font-weight: bold;
            font-family: 'Minecraft', 'Courier New', monospace;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0.8;
            z-index: 999;
        }

        /* Ekran boyutuna göre ince ayarlar */
        @media (max-width: 480px) {
            .container {
                padding: 15px;
                border-radius: 12px;
            }
            
            .game-info {
                flex-direction: column;
                gap: 8px;
            }
            
            .controls {
                gap: 10px;
            }
            
            button {
                min-width: 120px;
                padding: 8px 16px;
            }
            
            .letter {
                padding: 15px;
            }
        }

        @media (max-width: 360px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 12px;
            }
            
            .game-area {
                height: 220px;
            }
            
            .heart {
                width: 22px;
                height: 22px;
            }
            
            #basket {
                width: 70px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Azra İçin Kalp Toplama</h1>
        <div class="subtitle">Hayatımın anlamı Azra'ya 31.10.2025</div>

        <div class="game-info">
            <div>Toplanan Kalp: <span id="collected">0</span>/50</div>
            <div>Kalan Kalp: <span id="remaining">50</span></div>
        </div>

        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>

        <div class="game-area" id="game-area">
            <div id="basket"></div>
            <div class="romantic-messages" id="romantic-message"></div>
        </div>

        <div class="instructions">
            Ekrana dokunarak sepete yön verebilirsin.
        </div>

        <div class="completion-message" id="completion-message">
            Tebrikler! Tüm kalpleri topladınız! ❤️
        </div>

        <div class="controls">
            <button id="start-btn">Oyuna Başla</button>
            <button id="reset-btn">Yeniden Başlat</button>
        </div>
    </div>

    <div class="notification" id="notification">
        Tebrikler! 10 kalp topladınız! 🎊
    </div>

    <div class="letter" id="letter">
        <div class="letter-content">
            <div class="letter-header">
                <div class="couple-image">
                    <img src="ikimiz.png" alt="Biz">
                </div>
                <h2>Sevgili Azra,</h2>
            </div>
            <div class="letter-text">
                <p>Bu küçük oyunu senin için yaptım çünkü senin için hissettiklerimi kelimelerle anlatmak çok zor.</p>
                <p>Her topladığın kalp, senin için hissettiğim sevginin küçük bir temsili. Tıpkı bu kalpler gibi, sevgimiz de her geçen gün büyüyor ve güzelleşiyor.</p>
                <p>Azram, birtanem, hayatım... Birini sevmek dünyanın en güzel duygusu ve sen bana bu duyguyu bolca yaşatıyorsun. Her gülüşünde, gözlerinin içine baktığımda kendi mutluluğumu buluyorum. Yanımda çocuklaşman, aynı zamanda benimde senin yanında çocuklaşmam gibi durumlar benim için çok değerli. Sen benim için fazlasıyla özel birisin ve birbirimizi asla kaybetmememizi diliyorum. Seni bugün, yarın, sonsuza kadar sevmeye devam edeceğim.</p>
            </div>
            <div class="letter-signature">
                <p>Seni çok seven,</p>
                <p>Birtanennnn  🩵</p>
            </div>
            <button class="love-button" id="close-letter">Seni ne kadar çok sevdiğimi göster</button>
        </div>
    </div>

    <div class="percentage-display" id="percentage-display">%0</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const gameArea = document.getElementById('game-area');
            const basket = document.getElementById('basket');
            const collectedSpan = document.getElementById('collected');
            const remainingSpan = document.getElementById('remaining');
            const progressBar = document.getElementById('progress');
            const startBtn = document.getElementById('start-btn');
            const resetBtn = document.getElementById('reset-btn');
            const notification = document.getElementById('notification');
            const completionMessage = document.getElementById('completion-message');
            const romanticMessage = document.getElementById('romantic-message');
            const letter = document.getElementById('letter');
            const closeLetter = document.getElementById('close-letter');
            const percentageDisplay = document.getElementById('percentage-display');

            let collectedHearts = 0;
            const totalHearts = 50;
            let gameActive = false;
            let hearts = [];
            let basketPosition = (gameArea.offsetWidth - basket.offsetWidth) / 2;
            let heartInterval;
            let touchStartX = 0;
            let basketStartX = 0;

            // Ses efektleri için AudioContext
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();

            function playHeartSound() {
                try {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.frequency.value = 523.25; // C5 notası
                    oscillator.type = 'sine';

                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime); // Kısık ses
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.3);

                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                } catch (e) {
                    console.log("Kalp sesi çalınamadı: ", e);
                }
            }

            function playNotificationSound() {
                try {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    // Daha duyulur, neşeli bir ses
                    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime); // E5
                    oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.1); // G5
                    oscillator.frequency.setValueAtTime(1046.50, audioContext.currentTime + 0.2); // C6
                    oscillator.type = 'sine';

                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime); // Daha yüksek ses
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.5);

                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                } catch (e) {
                    console.log("Bildirim sesi çalınamadı: ", e);
                }
            }

            // Romantik mesajlar
            const romanticMessages = [
                "Birtanem, her kalp senin güzelliğinin bir yansıması ❤️",
                "Senin aşkın, hayatıma anlam katan en güzel şey 💖",
                "Her geçen gün seni daha çok seviyorum 🌹",
                "Gözlerin yıldızlar kadar güzel, gülüşün güneş kadar sıcak ✨",
                "Seninle her an bir masal kadar güzel 💫",
                "Sevgimiz zamanla büyüyen en güzel çiçek 🌷",
                "Kalbin her atışında, seni düşünüyorum 💓",
                "Sen hayatıma giren en güzel sürprizsin 🎁"
            ];

            // Konfeti efekti
            function createConfetti() {
                const colors = ['#ff0080', '#ff3399', '#ff69b4', '#ff1493', '#ff00ff', '#ff66b2'];
                const confettiCount = 150;

                for (let i = 0; i < confettiCount; i++) {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti');
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.top = '-20px';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = (Math.random() * 10 + 5) + 'px';
                    confetti.style.height = (Math.random() * 10 + 5) + 'px';
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;

                    document.body.appendChild(confetti);

                    // Animasyon
                    const animation = confetti.animate([
                        { transform: `translate(0, 0) rotate(0deg)`, opacity: 1 },
                        { transform: `translate(${Math.random() * 200 - 100}px, ${window.innerHeight}px) rotate(${Math.random() * 720}deg)`, opacity: 0 }
                    ], {
                        duration: Math.random() * 3000 + 2000,
                        easing: 'cubic-bezier(0.1, 0.8, 0.3, 1)'
                    });

                    animation.onfinish = () => {
                        confetti.remove();
                    };
                }
            }

            // Yüzdelik animasyonu (daha hızlı)
            function showPercentageAnimation() {
                percentageDisplay.style.display = 'block';
                let percentage = 0;

                const interval = setInterval(() => {
                    percentage += 2; // Daha hızlı artış

                    if (percentage <= 100) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else if (percentage <= 200) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else if (percentage <= 300) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else if (percentage <= 400) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else if (percentage <= 500) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else if (percentage <= 600) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else if (percentage <= 700) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else if (percentage <= 800) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else if (percentage <= 900) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else if (percentage <= 1000) {
                        percentageDisplay.textContent = `%${percentage}`;
                    } else {
                        percentageDisplay.textContent = '%∞';
                        clearInterval(interval);
                        createConfetti();

                        setTimeout(() => {
                            percentageDisplay.style.display = 'none';
                            letter.classList.remove('show');
                        }, 2000);
                        return;
                    }
                }, 10); // Çok daha hızlı interval
            }

            // Sepet pozisyonunu güncelle
            function updateBasketPosition() {
                basket.style.left = `${basketPosition}px`;
            }

            // Kalp oluştur
            function createHeart() {
                if (!gameActive) return;

                const heart = document.createElement('div');
                heart.classList.add('heart');

                const x = Math.random() * (gameArea.offsetWidth - 40);
                heart.style.left = `${x}px`;
                heart.style.top = '-40px';

                gameArea.appendChild(heart);

                const heartObj = {
                    element: heart,
                    x: x,
                    y: -40,
                    speed: 1 + Math.random() * 2
                };

                hearts.push(heartObj);
            }

            // Kalpleri hareket ettir
            function moveHearts() {
                for (let i = hearts.length - 1; i >= 0; i--) {
                    const heart = hearts[i];
                    heart.y += heart.speed;
                    heart.element.style.top = `${heart.y}px`;

                    // Kalp sepetle çarpıştı mı kontrol et
                    if (checkCollision(heart)) {
                        collectHeart(heart);
                        hearts.splice(i, 1);
                    }
                    // Kalp ekranın dışına çıktı mı kontrol et
                    else if (heart.y > gameArea.offsetHeight) {
                        heart.element.remove();
                        hearts.splice(i, 1);
                    }
                }
            }

            // Çarpışma kontrolü
            function checkCollision(heart) {
                const basketRect = {
                    left: basketPosition,
                    right: basketPosition + basket.offsetWidth,
                    top: gameArea.offsetHeight - basket.offsetHeight - 10,
                    bottom: gameArea.offsetHeight
                };

                const heartRect = {
                    left: parseFloat(heart.element.style.left),
                    right: parseFloat(heart.element.style.left) + heart.element.offsetWidth,
                    top: heart.y,
                    bottom: heart.y + heart.element.offsetHeight
                };

                return (
                    heartRect.bottom >= basketRect.top &&
                    heartRect.top <= basketRect.bottom &&
                    heartRect.right >= basketRect.left &&
                    heartRect.left <= basketRect.right
                );
            }

            // Kalp toplama
            function collectHeart(heart) {
                // Animasyonu başlat
                heart.element.classList.add('collected');

                // Kalp sesi çal
                playHeartSound();

                // Elementi animasyon bitince kaldır
                setTimeout(() => {
                    if (heart.element.parentNode) {
                        heart.element.remove();
                    }
                }, 500);

                collectedHearts++;
                updateGameInfo();

                // Her 10 kalpte bir bildirim göster
                if (collectedHearts % 10 === 0 && collectedHearts > 0) {
                    showNotification();
                    playNotificationSound();
                }

                // Tüm kalpler toplandığında
                if (collectedHearts === totalHearts) {
                    endGame();
                }
            }

            // Oyun bilgilerini güncelle
            function updateGameInfo() {
                collectedSpan.textContent = collectedHearts;
                remainingSpan.textContent = totalHearts - collectedHearts;
                const progressPercent = (collectedHearts / totalHearts) * 100;
                progressBar.style.width = `${progressPercent}%`;
            }

            // Bildirim göster
            function showNotification() {
                const randomMessage = romanticMessages[Math.floor(Math.random() * romanticMessages.length)];
                romanticMessage.textContent = randomMessage;
                romanticMessage.style.display = 'block';

                setTimeout(() => {
                    romanticMessage.style.display = 'none';
                }, 3000);
            }

            // Mektup göster
            function showLetter() {
                letter.classList.add('show');
            }

            // Oyunu başlat
            function startGame() {
                if (gameActive) return;

                gameActive = true;
                collectedHearts = 0;
                hearts = [];
                updateGameInfo();
                completionMessage.style.display = 'none';
                romanticMessage.style.display = 'none';
                letter.classList.remove('show');
                percentageDisplay.style.display = 'none';

                // Kalp oluşturma interval'i
                heartInterval = setInterval(createHeart, 800);

                // Oyun döngüsü
                function gameLoop() {
                    if (!gameActive) return;
                    moveHearts();
                    requestAnimationFrame(gameLoop);
                }

                gameLoop();
            }

            // Oyunu bitir
            function endGame() {
                gameActive = false;
                clearInterval(heartInterval);

                // Tüm kalpleri temizle
                hearts.forEach(heart => {
                    if (heart.element.parentNode) {
                        heart.element.remove();
                    }
                });
                hearts = [];

                completionMessage.style.display = 'block';
                showFinalNotification();

                // 2 saniye sonra mektup göster
                setTimeout(showLetter, 2000);
            }

            // Tüm kalpler toplandığında gösterilecek bildirim
            function showFinalNotification() {
                notification.textContent = "Harika Azra'm! Tüm kalpleri topladın! Seni çok seviyorum! ❤️";
                notification.classList.add('show');

                setTimeout(() => {
                    notification.classList.remove('show');
                }, 5000);
            }

            // Oyunu sıfırla
            function resetGame() {
                gameActive = false;
                clearInterval(heartInterval);

                // Tüm kalpleri temizle
                hearts.forEach(heart => {
                    if (heart.element.parentNode) {
                        heart.element.remove();
                    }
                });
                hearts = [];

                collectedHearts = 0;
                updateGameInfo();
                completionMessage.style.display = 'none';
                romanticMessage.style.display = 'none';
                notification.classList.remove('show');
                letter.classList.remove('show');
                percentageDisplay.style.display = 'none';

                // Konfetileri temizle
                document.querySelectorAll('.confetti').forEach(confetti => confetti.remove());
            }

            // Klavye kontrolleri
            document.addEventListener('keydown', function(e) {
                if (!gameActive) return;

                if (e.key === 'ArrowLeft') {
                    basketPosition = Math.max(0, basketPosition - 20);
                    updateBasketPosition();
                } else if (e.key === 'ArrowRight') {
                    basketPosition = Math.min(gameArea.offsetWidth - basket.offsetWidth, basketPosition + 20);
                    updateBasketPosition();
                }
            });

            // Dokunmatik kontroller
            let isDragging = false;

            gameArea.addEventListener('touchstart', function(e) {
                if (!gameActive) return;

                touchStartX = e.touches[0].clientX;
                basketStartX = basketPosition;
                isDragging = true;
                e.preventDefault();
            });

            gameArea.addEventListener('touchmove', function(e) {
                if (!gameActive || !isDragging) return;

                const touchX = e.touches[0].clientX;
                const deltaX = touchX - touchStartX;
                basketPosition = Math.max(0, Math.min(gameArea.offsetWidth - basket.offsetWidth, basketStartX + deltaX));
                updateBasketPosition();
                e.preventDefault();
            });

            gameArea.addEventListener('touchend', function() {
                isDragging = false;
            });

            // Fare kontrolleri
            gameArea.addEventListener('mousedown', function(e) {
                if (!gameActive) return;

                touchStartX = e.clientX;
                basketStartX = basketPosition;
                isDragging = true;
                e.preventDefault();
            });

            document.addEventListener('mousemove', function(e) {
                if (!gameActive || !isDragging) return;

                const touchX = e.clientX;
                const deltaX = touchX - touchStartX;
                basketPosition = Math.max(0, Math.min(gameArea.offsetWidth - basket.offsetWidth, basketStartX + deltaX));
                updateBasketPosition();
            });

            document.addEventListener('mouseup', function() {
                isDragging = false;
            });

            // Olay dinleyicileri
            startBtn.addEventListener('click', startGame);
            resetBtn.addEventListener('click', resetGame);
            closeLetter.addEventListener('click', showPercentageAnimation);

            // Başlangıç pozisyonunu ayarla
            updateBasketPosition();
        });
    </script>
</body>
</html>
